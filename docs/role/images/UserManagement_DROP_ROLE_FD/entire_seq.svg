<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="545px" preserveAspectRatio="none" style="width:969px;height:545px;background:#FFFFFF;" version="1.1" viewBox="0 0 969 545" width="969px" zoomAndPan="magnify"><defs><filter height="300%" id="fu6y0sj4wwx5f" width="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="2.0"/><feColorMatrix in="blurOut" result="blurOut2" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"/><feOffset dx="4.0" dy="4.0" in="blurOut2" result="blurOut3"/><feBlend in="SourceGraphic" in2="blurOut3" mode="normal"/></filter></defs><g><rect fill="#FFFFFF" filter="url(#fu6y0sj4wwx5f)" height="456.2188" style="stroke:#A80036;stroke-width:1.0;" width="10" x="86.5" y="64.6094"/><rect fill="#FFFFFF" filter="url(#fu6y0sj4wwx5f)" height="39.3516" style="stroke:#A80036;stroke-width:1.0;" width="10" x="91.5" y="117.3125"/><rect fill="#FFFFFF" filter="url(#fu6y0sj4wwx5f)" height="55.7031" style="stroke:#A80036;stroke-width:1.0;" width="10" x="91.5" y="382.125"/><rect fill="#FFFFFF" filter="url(#fu6y0sj4wwx5f)" height="433.8672" style="stroke:#A80036;stroke-width:1.0;" width="10" x="233.5" y="86.9609"/><rect fill="#FFFFFF" filter="url(#fu6y0sj4wwx5f)" height="319.8125" style="stroke:#A80036;stroke-width:1.0;" width="10" x="409.5" y="187.0156"/><rect fill="#FFFFFF" filter="url(#fu6y0sj4wwx5f)" height="125.4063" style="stroke:#A80036;stroke-width:1.0;" width="10" x="570" y="326.4219"/><rect fill="#FFFFFF" filter="url(#fu6y0sj4wwx5f)" height="262.2852" style="stroke:#A80036;stroke-width:1.0;" width="10" x="705" y="230.543"/><rect fill="#FFFFFF" filter="url(#fu6y0sj4wwx5f)" height="180.7578" style="stroke:#A80036;stroke-width:1.0;" width="10" x="710" y="291.0703"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="91" x2="91" y1="54.6094" y2="538.8281"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="238" x2="238" y1="54.6094" y2="538.8281"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="414" x2="414" y1="54.6094" y2="538.8281"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="575" x2="575" y1="54.6094" y2="538.8281"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="709.5" x2="709.5" y1="54.6094" y2="538.8281"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="77" x="50" y="51.5332">PostgreSQL</text><ellipse cx="91.5" cy="21" fill="#FEFECE" filter="url(#fu6y0sj4wwx5f)" rx="12" ry="12" style="stroke:#A80036;stroke-width:2.0;"/><polygon fill="#A80036" points="87.5,9,93.5,4,91.5,9,93.5,14,87.5,9" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="115" x="178" y="51.5332">frontend(alt-utility)</text><ellipse cx="238.5" cy="21" fill="#FEFECE" filter="url(#fu6y0sj4wwx5f)" rx="12" ry="12" style="stroke:#A80036;stroke-width:2.0;"/><polygon fill="#A80036" points="234.5,9,240.5,4,238.5,9,240.5,14,234.5,9" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="169" x="327" y="51.5332">manager(message-broker)</text><ellipse cx="414.5" cy="21" fill="#FEFECE" filter="url(#fu6y0sj4wwx5f)" rx="12" ry="12" style="stroke:#A80036;stroke-width:2.0;"/><polygon fill="#A80036" points="410.5,9,416.5,4,414.5,9,416.5,14,410.5,9" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="120" x="512" y="51.5332">metadata-manager</text><ellipse cx="575" cy="21" fill="#FEFECE" filter="url(#fu6y0sj4wwx5f)" rx="12" ry="12" style="stroke:#A80036;stroke-width:2.0;"/><polygon fill="#A80036" points="571,9,577,4,575,9,577,14,571,9" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="75" x="669.5" y="51.5332">ogawayama</text><ellipse cx="710" cy="21" fill="#FEFECE" filter="url(#fu6y0sj4wwx5f)" rx="12" ry="12" style="stroke:#A80036;stroke-width:2.0;"/><polygon fill="#A80036" points="706,9,712,4,710,9,712,14,706,9" style="stroke:#A80036;stroke-width:1.0;"/><rect fill="#FFFFFF" filter="url(#fu6y0sj4wwx5f)" height="456.2188" style="stroke:#A80036;stroke-width:1.0;" width="10" x="86.5" y="64.6094"/><rect fill="#FFFFFF" filter="url(#fu6y0sj4wwx5f)" height="39.3516" style="stroke:#A80036;stroke-width:1.0;" width="10" x="91.5" y="117.3125"/><rect fill="#FFFFFF" filter="url(#fu6y0sj4wwx5f)" height="55.7031" style="stroke:#A80036;stroke-width:1.0;" width="10" x="91.5" y="382.125"/><rect fill="#FFFFFF" filter="url(#fu6y0sj4wwx5f)" height="433.8672" style="stroke:#A80036;stroke-width:1.0;" width="10" x="233.5" y="86.9609"/><rect fill="#FFFFFF" filter="url(#fu6y0sj4wwx5f)" height="319.8125" style="stroke:#A80036;stroke-width:1.0;" width="10" x="409.5" y="187.0156"/><rect fill="#FFFFFF" filter="url(#fu6y0sj4wwx5f)" height="125.4063" style="stroke:#A80036;stroke-width:1.0;" width="10" x="570" y="326.4219"/><rect fill="#FFFFFF" filter="url(#fu6y0sj4wwx5f)" height="262.2852" style="stroke:#A80036;stroke-width:1.0;" width="10" x="705" y="230.543"/><rect fill="#FFFFFF" filter="url(#fu6y0sj4wwx5f)" height="180.7578" style="stroke:#A80036;stroke-width:1.0;" width="10" x="710" y="291.0703"/><polygon fill="#A80036" points="221.5,82.9609,231.5,86.9609,221.5,90.9609,225.5,86.9609" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="96.5" x2="227.5" y1="86.9609" y2="86.9609"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="118" x="103.5" y="82.1045">hook DDL command</text><polygon fill="#A80036" points="112.5,113.3125,102.5,117.3125,112.5,121.3125,108.5,117.3125" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="106.5" x2="232.5" y1="117.3125" y2="117.3125"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="86" x="118.5" y="112.4561">DDL command</text><polygon fill="#A80036" points="221.5,152.6641,231.5,156.6641,221.5,160.6641,225.5,156.6641" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="96.5" x2="227.5" y1="156.6641" y2="156.6641"/><polygon fill="#A80036" points="397.5,183.0156,407.5,187.0156,397.5,191.0156,401.5,187.0156" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="243.5" x2="403.5" y1="187.0156" y2="187.0156"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="147" x="250.5" y="182.1592">message(DDL command)</text><polygon fill="#A80036" points="693,226.543,703,230.543,693,234.543,697,230.543" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="419.5" x2="699" y1="230.543" y2="230.543"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="182" x="426.5" y="225.6865">send_message(DDL command)</text><path d="M720,200.0156 L720,242.0156 L960,242.0156 L960,210.0156 L950,200.0156 L720,200.0156 " fill="#FBFB77" filter="url(#fu6y0sj4wwx5f)" style="stroke:#A80036;stroke-width:1.0;"/><path d="M950,200.0156 L950,210.0156 L960,210.0156 L950,200.0156 " fill="#FBFB77" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="219" x="726" y="218.5107">ここでDROP ROLEメッセージ送信に</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="195" x="726" y="234.8623">失敗したときの動作を検討する。</text><line style="stroke:#A80036;stroke-width:1.0;" x1="715" x2="762" y1="278.0703" y2="278.0703"/><line style="stroke:#A80036;stroke-width:1.0;" x1="762" x2="762" y1="278.0703" y2="291.0703"/><line style="stroke:#A80036;stroke-width:1.0;" x1="721" x2="762" y1="291.0703" y2="291.0703"/><polygon fill="#A80036" points="731,287.0703,721,291.0703,731,295.0703,727,291.0703" style="stroke:#A80036;stroke-width:1.0;"/><polygon fill="#A80036" points="591,322.4219,581,326.4219,591,330.4219,587,326.4219" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="585" x2="709" y1="326.4219" y2="326.4219"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="106" x="597" y="321.5654">get/update/remove</text><polygon fill="#A80036" points="112.5,378.125,102.5,382.125,112.5,386.125,108.5,382.125" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="106.5" x2="569" y1="382.125" y2="382.125"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="86" x="118.5" y="377.2686">DDL command</text><polygon fill="#A80036" points="558,433.8281,568,437.8281,558,441.8281,562,437.8281" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="96.5" x2="564" y1="437.8281" y2="437.8281"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="130" x="103.5" y="432.9717">: DDL command result</text><polygon fill="#A80036" points="698,447.8281,708,451.8281,698,455.8281,702,451.8281" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="575" x2="704" y1="451.8281" y2="451.8281"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="720" x2="762" y1="470.8281" y2="470.8281"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="762" x2="762" y1="470.8281" y2="483.8281"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="715" x2="762" y1="483.8281" y2="483.8281"/><polygon fill="#A80036" points="725,479.8281,715,483.8281,725,487.8281,721,483.8281" style="stroke:#A80036;stroke-width:1.0;"/><polygon fill="#A80036" points="430.5,488.8281,420.5,492.8281,430.5,496.8281,426.5,492.8281" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="424.5" x2="709" y1="492.8281" y2="492.8281"/><polygon fill="#A80036" points="254.5,502.8281,244.5,506.8281,254.5,510.8281,250.5,506.8281" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="248.5" x2="413.5" y1="506.8281" y2="506.8281"/><polygon fill="#A80036" points="102.5,516.8281,92.5,520.8281,102.5,524.8281,98.5,520.8281" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="96.5" x2="237.5" y1="520.8281" y2="520.8281"/><!--MD5=[21064fe02b04935d8cae4627322c03eb]
@startuml entire_seq
hide footbox

control PostgreSQL as pg
control "frontend(alt-utility)" as frontend
control "manager(message-broker)" as msgbroker
control "metadata-manager" as metadata

control "ogawayama" as stub

activate pg
  pg -> frontend : hook DDL command
  activate frontend
    frontend -> pg : DDL command
    activate pg
      alt option
    return
    frontend -> msgbroker : message(DDL command)
    activate msgbroker
      msgbroker -> stub : send_message(DDL command)
      note right
        ここでDROP ROLEメッセージ送信に
        失敗したときの動作を検討する。
      end note
      activate stub
        alt option
        stub -> stub
        activate stub
          stub -> metadata : get/update/remove
          activate metadata
            alt option
            metadata -> pg : DDL command
            activate pg
              alt option
            return : DDL command result
          return
        return
      return 
    return
  return
deactivate pg
@enduml

PlantUML version 1.2021.7(Sun May 23 21:40:07 JST 2021)
(GPL source distribution)
Java Runtime: Java(TM) SE Runtime Environment
JVM: Java HotSpot(TM) Client VM
Default Encoding: MS932
Language: ja
Country: JP
--></g></svg>